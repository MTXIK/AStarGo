# Алгоритмы Поиска Пути на Картах Высот

## Обзор

Этот проект реализует алгоритмы поиска пути на картах высот с использованием языка программирования Go. Поддерживаются алгоритм Дейкстры и алгоритм A* с тремя различными эвристическими функциями: Манхэттен, Евклид и Чебышев. Приложение читает бинарный файл с картой высот, вычисляет кратчайший путь между заданными стартовой и конечной точками, записывает показатели производительности и генерирует визуализации путей.

## Возможности

- **Алгоритм Дейкстры:** Находит кратчайший путь без использования эвристик.
- **Алгоритм A\*:** Повышает эффективность поиска пути с использованием эвристик.
  - **Манхэттенская эвристика:** Подходит для карт на сетке, где движения ограничены горизонтальными и вертикальными направлениями.
  - **Евклидова эвристика:** Подходит для карт с разрешенными диагональными движениями.
  - **Чебышевская эвристика:** Комбинирует аспекты Манхэттенской и Евклидовой эвристик.
- **Обработка Карт Высот:** Читает данные высот из бинарных файлов для влияния на стоимость пути.
- **Визуализация:** Генерирует PNG-изображения карты высот с наложенными вычисленными путями.
- **Показатели Производительности:** Записывает длину пути, процент просмотренных узлов и время выполнения для каждого алгоритма.
- **Командный Интерфейс:** Удобные флаги для указания входных/выходных файлов, координат начала/конца пути и масштаба визуализации.

## Содержание

- [Установка](#установка)
- [Использование](#использование)
- [Формат Входного Файла](#формат-входного-файла)
- [Выходные Данные](#выходные-данные)
- [Визуализация](#визуализация)
- [Тесты](#тесты)
- [Алгоритмы](#алгоритмы)
- [Зависимости](#зависимости)

## Установка

1. **Клонируйте Репозиторий:**

   ```bash
   git clone https://github.com/yourusername/AStarGo.git
   cd AStarGo
   ```

2. **Установите Зависимости:**

   Проект использует библиотеку `fogleman/gg` для рисования. Убедитесь, что у вас установлен Go (рекомендуется версия 1.16 или новее).

   ```bash
   go get github.com/fogleman/gg
   ```

3. **Соберите Приложение:**

   ```bash
   go build -o pathfinder src/main.go
   ```

## Использование

Запустите скомпилированный исполняемый файл с необходимыми флагами:

```bash
./pathfinder -i input_file.bin -o output.txt -sx X_START -sy Y_START -ex X_END -ey Y_END -scale SCALE
```

### Флаги Командной Строки

- `-i` (строка, **обязательный**): **Имя входного файла**, содержащего бинарную карту высот.
- `-o` (строка, опционально, по умолчанию: `output.txt`): **Имя выходного файла** для записи результатов.
- `-sx` (int, **обязательный**): **Координата X** начальной точки пути.
- `-sy` (int, **обязательный**): **Координата Y** начальной точки пути.
- `-ex` (int, **обязательный**): **Координата X** конечной точки пути.
- `-ey` (int, **обязательный**): **Координата Y** конечной точки пути.
- `-scale` (int, опционально, по умолчанию: `5`): **Масштаб** для визуализации (пиксели на клетку карты).

### Пример

```bash
./pathfinder -i tests/map_001.map -o results_map_001.txt -sx 10 -sy 15 -ex 200 -ey 300 -scale 10
```

## Формат Входного Файла

Входной файл должен быть бинарным файлом со следующей структурой:

1. **Ширина (int16):** Ширина карты высот.
2. **Высота (int16):** Высота карты высот.
3. **Данные Высот (массив int16):** Последовательность `width * height` значений int16, представляющих высоту в каждой клетке, упорядоченных по строкам.

### Пример Генерации

Для создания примера файла карты высот можно использовать следующий фрагмент кода на Go:

```go
package main

import (
    "encoding/binary"
    "os"
)

func main() {
    width, height := int16(100), int16(100)
    file, _ := os.Create("tests/map_001.map")
    defer file.Close()
    binary.Write(file, binary.LittleEndian, width)
    binary.Write(file, binary.LittleEndian, height)
    data := make([]int16, width*height)
    // Заполните data вашими значениями высот
    binary.Write(file, binary.LittleEndian, data)
}
```

## Выходные Данные

Приложение генерирует следующие выходные данные:

1. **Файл Результатов (`output.txt` по умолчанию):** Содержит показатели производительности и пути, вычисленные каждым алгоритмом.

   ```plaintext
   Алгоритм: Дейкстра
   Длина пути: 1234.56
   Процент просмотренных вершин: 45%
   Время выполнения: 12.34 ms
   Путь: (10,15) -> (11,16) -> ... -> (200,300)

   Алгоритм: A* (Манхэттенская эвристика)
   Длина пути: 1230.50
   Процент просмотренных вершин: 30%
   Время выполнения: 8.90 ms
   Путь: (10,15) -> (11,16) -> ... -> (200,300)

   ... и так далее для каждого алгоритма
   ```

2. **Изображения Визуализации:**

   - `dijkstra_path.png`
   - `astar_manhattan_path.png`
   - `astar_euclidean_path.png`
   - `astar_chebyshev_path.png`

   Каждое изображение отображает карту высот с наложенным соответствующим путем.

## Визуализация

Визуализация создается с использованием библиотеки `fogleman/gg`. Карта высот окрашена в зависимости от значений высот, а вычисленный путь наложен черной линией с отмеченными начальной и конечной точками зелёным и синим цветом соответственно.

### Настройка Визуализации

- **Масштаб (`-scale` флаг):** Регулирует размер каждой клетки на PNG-изображении. Более высокий масштаб приводит к большему изображению с более заметными путями.

## Тесты

В директории `tests` находятся различные карты высот и соответствующие ожидаемые результаты. Структура файлов:

- **Карты Высот:**
  - `map_001.map`, `map_002.map`, ..., `map_007.map`: Бинарные файлы с картами высот.
  - `map_001.txt`, `map_002.txt`, ..., `map_007.txt`: Текстовые описания или дополнительные данные для карт.

- **Ожидаемые Результаты:**
  - `map_001_ans_001.png`, `map_001_ans_002.png`, `map_001_ans_003.png`: Визуализации путей, найденных различными алгоритмами.
  - `map_001_ans_001.txt`, `map_001_ans_002.txt`, `map_001_ans_003.txt`: Текстовые файлы с описанием путей и показателями производительности.
  
- **Другие Файлы:**
  - `map_005_ans_001.png`, `map_006_ans_002.txt`, и т.д.: Аналогичные файлы для других карт.

### Запуск Тестов

Для запуска тестов используйте различные карты из директории `tests`. Пример запуска:

```bash
./pathfinder -i tests/map_001.map -o results_map_001.txt -sx 10 -sy 15 -ex 90 -ey 90 -scale 10
```

После выполнения вы получите результаты в `results_map_001.txt` и визуализацию пути в `dijkstra_path.png`, `astar_manhattan_path.png` и других соответствующих файлах.

## Алгоритмы

### Алгоритм Дейкстры

- **Описание:** Алгоритм поиска пути по графу, который находит кратчайший путь от начальной вершины до всех остальных вершин графа. Не использует эвристики.
- **Сценарий Использования:** Лучше всего подходит, когда эвристика недоступна или когда все веса рёбер неотрицательны.

### Алгоритм A\*

- **Описание:** Расширение алгоритма Дейкстры, которое использует эвристики для направления поиска, потенциально уменьшая количество узлов, которые необходимо исследовать.
- **Реализованные Эвристики:**
  - **Манхэттенская:** `|x1 - x2| + |y1 - y2|`
  - **Евклидова:** `√((x1 - x2)² + (y1 - y2)²)`
  - **Чебышевская:** `max(|x1 - x2|, |y1 - y2|)`

### Функция Стоимости

Стоимость перемещения из одной клетки в другую учитывает как базовую стоимость перемещения, так и разницу в высотах между двумя клетками. Используемая формула:

```
Стоимость = 1.0 + (вес * |высота_до - высота_от|)
```

Где `вес` — это константа (установленная в `25.0` в коде), определяющая влияние разницы высот на стоимость пути.

## Зависимости

- **Стандартные Библиотеки Go:**
  - `container/heap`
  - `encoding/binary`
  - `flag`
  - `fmt`
  - `image/color`
  - `math`
  - `os`
  - `time`
- **Сторонние Библиотеки:**
  - [`github.com/fogleman/gg`](https://github.com/fogleman/gg): Библиотека Go для создания 2D графики.
